<!--
  CHANGE 1: Background Color
  Replaced 'bg-white/80' with 'bg-base-100/80'.
  'base-100' is white in light mode and dark grey/black in dark mode.
-->
<header
  th:fragment="header"
  class="w-full border-b border-base-200 bg-base-100/80 backdrop-blur supports-[backdrop-filter]:bg-base-100/60 sticky top-0 z-50"
>
  <nav class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
    <!-- Left: Logo + Version Badge -->
    <div class="flex items-center gap-4">
      <!-- CHANGE 2: Text Color -->
      <!-- Added 'text-base-content' (automatically handles black/white text) -->
      <a th:href="@{/}" class="flex items-center gap-2 text-primary">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-10 h-10 text-green-500"
          viewBox="0 0 10240 10240"
          role="img"
          aria-label="Tunehub logo"
          fill="currentColor"
        >
          <path
            d="M8284 9162 c-2 -207 -55 -427 -161 -667 -147 -333 -404 -644 -733 -886 -81 -59 -247 -169 -256 -169 -3 0 -18 -9 -34 -20 -26 -19 -344 -180 -354 -180 -3 0 -29 -11 -58 -24 -227 -101 -642 -225 -973 -290 -125 -25 -397 -70 -480 -80 -22 -3 -76 -9 -120 -15 -100 -13 -142 -17 -357 -36 -29 -2 -98 -7 -153 -10 -267 -15 -436 -28 -525 -40 -14 -2 -45 -7 -70 -10 -59 -8 -99 -14 -130 -20 -14 -3 -41 -7 -60 -11 -19 -3 -39 -7 -45 -8 -5 -2 -28 -6 -50 -10 -234 -45 -617 -165 -822 -257 -23 -10 -45 -19 -48 -19 -7 0 -284 -138 -340 -170 -631 -355 -1107 -842 -1402 -1432 -159 -320 -251 -633 -308 -1056 -26 -190 -27 -635 -1 -832 3 -19 7 -59 10 -89 4 -30 11 -84 17 -120 6 -36 12 -77 14 -91 7 -43 33 -174 39 -190 3 -8 7 -28 9 -45 6 -35 52 -221 72 -285 7 -25 23 -79 35 -120 29 -99 118 -283 189 -389 67 -103 203 -244 286 -298 75 -49 178 -103 196 -103 16 0 27 16 77 110 124 231 304 529 485 800 82 124 153 227 157 230 3 3 28 36 54 74 116 167 384 497 546 671 148 160 448 450 560 542 14 12 54 45 90 75 88 73 219 172 313 238 42 29 77 57 77 62 0 5 -13 34 -29 66 -69 137 -149 405 -181 602 -7 41 -14 82 -15 90 -1 8 -6 46 -10 83 -3 37 -8 77 -10 88 -2 11 -7 65 -11 122 -3 56 -8 104 -9 107 -2 3 0 12 5 19 6 10 10 8 15 -10 10 -34 167 -346 228 -454 118 -210 319 -515 340 -515 4 0 40 18 80 40 230 128 521 255 787 343 118 40 336 102 395 113 28 5 53 11 105 23 25 5 59 12 75 15 17 3 41 8 55 11 34 7 274 43 335 50 152 18 372 29 565 29 194 0 481 -11 489 -19 2 -3 -3 -6 -12 -6 -9 -1 -20 -2 -24 -3 -33 -8 -73 -16 -98 -21 -61 -10 -264 -56 -390 -90 -649 -170 -1243 -437 -1770 -794 -60 -41 -121 -82 -134 -93 l-24 -18 124 -59 c109 -52 282 -116 404 -149 92 -26 192 -51 220 -55 17 -3 64 -12 105 -21 71 -14 151 -28 230 -41 19 -3 46 -7 60 -10 14 -2 45 -7 70 -10 25 -4 56 -8 70 -10 14 -2 53 -7 88 -10 35 -4 71 -8 81 -10 10 -2 51 -6 92 -9 101 -9 141 -14 147 -21 3 -3 -15 -5 -39 -6 -24 0 -52 -2 -62 -4 -21 -4 -139 -12 -307 -22 -242 -14 -700 -7 -880 13 -41 4 -187 27 -250 39 -125 23 -274 68 -373 111 -43 19 -81 34 -86 34 -4 0 -16 -8 -27 -17 -10 -10 -37 -33 -59 -52 -166 -141 -422 -395 -592 -586 -228 -257 -536 -672 -688 -925 -21 -36 -43 -66 -47 -68 -4 -2 -8 -7 -8 -11 0 -5 -24 -48 -54 -97 -156 -261 -493 -915 -480 -935 2 -3 47 -21 101 -38 54 -18 107 -36 118 -41 58 -25 458 -138 640 -181 118 -27 126 -29 155 -35 14 -2 45 -9 70 -14 66 -15 137 -28 300 -55 37 -7 248 -33 305 -39 28 -3 84 -9 125 -13 163 -16 792 -8 913 12 12 2 58 9 102 15 248 35 423 76 665 157 58 19 134 46 170 60 86 33 344 156 348 166 2 4 8 7 13 7 14 0 205 116 303 184 180 126 287 216 466 396 282 281 511 593 775 1055 43 75 178 347 225 455 100 227 236 602 286 790 59 220 95 364 120 485 6 28 45 245 50 275 2 14 7 41 10 60 3 19 8 49 10 65 2 17 6 46 9 65 15 100 35 262 40 335 3 39 8 89 10 112 22 225 33 803 21 1043 -3 41 -7 129 -11 195 -3 66 -8 136 -10 155 -2 19 -6 76 -10 125 -3 50 -8 101 -10 115 -2 14 -6 57 -10 95 -7 72 -12 113 -20 175 -2 19 -7 55 -10 80 -6 46 -43 295 -51 340 -2 14 -9 54 -15 90 -5 36 -16 97 -24 135 -8 39 -17 84 -20 100 -12 68 -18 97 -50 248 -19 87 -47 204 -61 260 -14 56 -27 109 -29 117 -30 147 -232 810 -253 832 -4 4 -7 -23 -8 -60z"
          />
        </svg>

        <span class="text-2xl font-semibold text-base-content">TuneHub</span>
      </a>

      <!-- CHANGE 3: Badge Background -->
      <!-- Replaced 'bg-gray-100' with 'bg-base-200' and text color with 'text-base-content/70' -->
      <button
        class="hidden sm:flex items-center gap-1 px-2 py-1 rounded-full bg-base-200 text-base-content/70 text-sm font-medium hover:bg-base-300 transition-colors"
      >
        v1.0
      </button>
    </div>

    <!-- Middle: Search bar -->
    <div class="hidden md:flex items-center relative text-base-content">
      <!-- CHANGE 4: Input Colors -->
      <!--
               - Bg: 'bg-gray-100' -> 'bg-base-200'
               - Placeholder: Added 'placeholder:text-base-content/50'
               - Focus Ring: 'focus:ring-primary' (uses your theme color instead of gray)
            -->
      <input
        type="text"
        placeholder="Search..."
        class="w-64 h-9 pl-10 pr-3 rounded-full bg-base-200 text-sm focus:ring-2 focus:ring-primary outline-none placeholder:text-base-content/50 transition-all"
      />

      <!-- Icon Color: 'text-gray-500' -> 'text-base-content/60' -->
      <svg
        class="absolute left-3 top-2 w-5 h-5 text-base-content/60"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"
        />
      </svg>

      <!-- Shortcut Hint: Border and Text adjustments -->
      <span
        class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-base-content/50 border border-base-300 rounded px-1"
      >
        Ctrl K
      </span>
    </div>

    <!-- Right: Menu Items -->
    <!-- CHANGE 5: Menu Text Color -> 'text-base-content' -->
    <ul
      class="hidden md:flex items-center gap-6 text-base-content text-sm font-medium"
    >
      <!-- USER AVATAR LOGIC -->
      <li th:if="${session.userEmail != null}" class="flex items-center">
        <div class="dropdown dropdown-end">
          <div
            tabindex="0"
            role="button"
            class="btn btn-ghost btn-circle avatar"
          >
            <div
              class="w-10 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2"
            >
              <img
                alt="User Avatar"
                th:src="@{/avatars/default/notion_1.png}"
              />
            </div>
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow-lg bg-base-100 rounded-box w-52 border border-base-200"
          >
            <li class="menu-title px-4 py-1 opacity-70">
              <span th:text="${session.userEmail}">user@email.com</span>
            </li>
            <div class="divider my-0"></div>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Settings</a></li>
            <li>
              <form th:action="@{/users/logout}" method="post">
                <button
                  type="submit"
                  class="w-full text-left text-error hover:bg-error/10"
                >
                  Logout
                </button>
              </form>
            </li>
          </ul>
        </div>
      </li>

      <!-- Login Button (If user is null) - Added this back just in case -->
      <li th:if="${session.userEmail == null}">
        <a th:href="@{/users/login}" class="btn btn-sm btn-ghost">Login</a>
      </li>

      <!-- Premium Badge -->
      <li>
        <div class="badge badge-soft badge-primary">
          <a th:href="@{#}">Premium</a>
        </div>
      </li>

      <!-- Github Icon -->
      <li>
        <a
          th:href="@{https://ashirbaddash.github.io/Tunehub}"
          aria-label="GitHub"
          class="hover:text-primary transition-colors"
          target="_blank"
        >
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path
              fill-rule="evenodd"
              d="M12 2C6.48 2 2 6.58 2 12.26c0 4.5 2.87 8.31 6.84 9.67.5.1.68-.22.68-.48 0-.24-.01-.87-.01-1.71-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.1-1.49-1.1-1.49-.9-.63.07-.62.07-.62 1 .08 1.53 1.06 1.53 1.06.89 1.56 2.34 1.11 2.91.84.09-.66.35-1.11.63-1.37-2.22-.26-4.56-1.14-4.56-5.08 0-1.12.38-2.03 1.03-2.74-.1-.26-.45-1.32.1-2.75 0 0 .84-.28 2.75 1.05A9.34 9.34 0 0112 6.82c.85.01 1.71.12 2.51.34 1.9-1.33 2.74-1.05 2.74-1.05.55 1.43.21 2.49.1 2.75.64.71 1.03 1.62 1.03 2.74 0 3.95-2.34 4.82-4.57 5.08.36.32.68.95.68 1.93 0 1.39-.01 2.5-.01 2.84 0 .26.18.58.69.48A10.26 10.26 0 0022 12.26C22 6.58 17.52 2 12 2z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </li>

      <!-- CHANGE 6: Theme Controller -->
      <!-- Changed value to 'dark' so checking the box activates dark mode -->
      <label class="flex cursor-pointer gap-2">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-base-content/70"
        >
          <circle cx="12" cy="12" r="5" />
          <path
            d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"
          />
        </svg>

        <input
          type="checkbox"
          value="dark"
          class="toggle theme-controller"
          id="themeCheckbox"
        />

        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-base-content/70"
        >
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </label>
    </ul>


    <div class="flex dropdown dropdown-end md:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-circle">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h7"
          />
        </svg>
      </div>
      <ul
        class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52"
      >
        <li th:if="${session.userEmail == null}">
          <a th:href="@{/users/login}">Login</a>
        </li>

        <li th:if="${session.userEmail != null}">
          <details>
            <summary th:text="${session.userEmail}">User</summary>
            <ul>
              <li><a href="#">Profile</a></li>
              <li><a href="#">Settings</a></li>
              <li>
                <form  th:action="@{/users/logout}" method="post">
                  <button 
                </form>
                <a th:href="@{/users/logout}" class="text-error">Logout</a>
              </li>
            </ul>
          </details>
        </li>

        <!-- Mobile Premium -->
        <li class="text-accent-content bg-accent">
          <a th:href="@{#}">Premium</a>
        </li>

        <li>
          <label class="flex gap-2">
            Theme
            <input
              type="checkbox"
              value="dark"
              class="toggle theme-controller toggle-sm"
            />-->
          </label>
        </li>
      </ul>
    </div>
  </nav>
</header>
