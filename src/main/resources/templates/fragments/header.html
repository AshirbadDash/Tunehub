<nav
  th:fragment="header"
  class="navbar fixed inset-x-0 top-0 z-10 transition-all backdrop-blur-md border-b border-border-default h-16 px-4 md:px-8 lg:px-16"
>
  <!-- LEFT: LOGO -->
  <div id="nav" class="flex-1">
    <a
      th:href="@{/}"
      class="inline-flex items-center gap-2 text-primary cursor-pointer text-2xl font-medium tracking-wide capitalize pointer-events-auto"
    >
      <svg
        role="img"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 fill-brand-yellow"
      >
        <title>Tunehub</title>
        <path
          d="M1.273 4.153a.971.971 0 0 1 .917-.65h21.325a.486.486 0 0 1 .458.646l-1.245 3.56a.971.971 0 0 1-.917.65H.486a.486.486 0 0 1-.459-.646Zm4.855 6.07a.971.971 0 0 1 .917-.65h8.337a.486.486 0 0 1 .458.645l-1.245 3.56a.971.971 0 0 1-.917.65H5.341a.486.486 0 0 1-.458-.646Zm2.698 6.068a.971.971 0 0 1 .917-.65h3.482a.486.486 0 0 1 .458.646l-1.246 3.56a.971.971 0 0 1-.916.65H8.039a.486.486 0 0 1-.458-.646Z"
        />
      </svg>
      Tunehub
    </a>
  </div>

  <!-- RIGHT: AUTH AREA -->
  <div class="flex flex-none gap-2 items-center">
    <!-- Theme Toggle -->
    <!-- <style>
      html.dark #theme-toggle:hover {
        background-color: var(--color-zinc-700); 
      }
    </style> -->
<button
  id="theme-toggle"
  class="p-2 rounded-full cursor-pointer
         bg-transparent
         focus:outline-none"
  aria-label="Toggle theme"
>

      <!-- Sun icon (shown in dark mode) -->
      <svg
        id="theme-toggle-sun"
        class="w-6 h-6 hidden"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
        ></path>
      </svg>
      <!-- Moon icon (shown in light mode) -->
      <svg
        id="theme-toggle-moon"
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
        ></path>
      </svg>
    </button>

    <!-- ================= LOGGED IN ================= -->
    <div th:if="${session.USER_ID != null}" class="dropdown dropdown-end">
      <!-- Avatar -->
      <div
        tabindex="0"
        role="button"
        class="cursor-pointer transition-all duration-200 rounded-full p-2 hover:bg-bg-surface-muted/40 bg-transparent"
      >
        <div
          class="w-10 h-10 rounded-full ring-2 ring-inset ring-transparent focus:ring-gray-400 transition-all duration-200 overflow-hidden"
        >
          <img
            alt="Profile"
            th:src="@{/avatars/default/notion_1.png}"
            class="w-full h-full object-cover"
          />
        </div>
      </div>

      <!-- Dropdown -->
      <div
        tabindex="0"
        class="dropdown-content bg-white shadow-brutal-black-sm rounded-none z-1000 mt-3 w-64 p-2 border border-border-default outline-none hover:shadow-brutal-md hover:text-text-secondary transition-all duration-150"
      >
        <!-- User Info -->
        <div class="px-4 py-3 mb-1">
          <div class="flex items-center gap-3">
            <div
              class="w-10 h-10 rounded-full ring-2 ring-hover-blue overflow-hidden"
            >
              <img
                alt="Profile"
                th:src="@{/avatars/default/notion_1.png}"
                class="w-full h-full object-cover"
              />
            </div>

            <div class="flex-1 min-w-0">
              <p
                class="text-sm text-text-secondary truncate"
                th:text="${session.USERNAME}"
              >
                Username
              </p>
              <p
                class="text-xs text-text-secondary/60 truncate"
                th:text="${session.ROLE}"
              >
                CUSTOMER
              </p>
            </div>
          </div>
        </div>

        <div class="h-px bg-bg-surface my-1"></div>

        <!-- Dashboard -->
        <div class="space-y-1 p-1">
          <a
            th:href="@{/users/dashboard}"
            class="flex items-center gap-3 px-3 py-2.5 hover:bg-blue-50 transition-all duration-150 group cursor-pointer"
          >
            <div
              class="w-9 h-9 rounded-none bg-code-function/60 flex items-center justify-center group-hover:bg-hover-blue transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 text-brand-blue"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                />
              </svg>
            </div>
            <div class="flex-1">
              <p class="text-sm text-brand-blue">Dashboard</p>
              <p class="text-xs text-text-secondary">View your dashboard</p>
            </div>
          </a>
        </div>

        <div class="h-px bg-bg-surface my-1"></div>

        <!-- Logout -->
        <div class="p-1">
          <form th:action="@{/logout}" method="post" class="m-0">
            <button
              type="submit"
              class="w-full flex items-center gap-3 px-3 py-2.5 rounded-none hover:bg-red-50 transition-all duration-150 group text-left"
            >
              <div
                class="w-9 h-9 rounded-none bg-code-class/60 flex items-center justify-center group-hover:bg-hover-red transition-colors"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5 text-brand-red"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                  />
                </svg>
              </div>
              <div class="flex-1">
                <p class="text-sm text-brand-red">Sign out</p>
                <p class="text-xs text-text-secondary">
                  Log out of your account
                </p>
              </div>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ================= LOGGED OUT ================= -->
    <div th:if="${session.USER_ID == null}">
      <!-- <th:block
        th:insert="~{fragments/button :: exploreButton('login', '/login')}"
      >
      </th:block> -->
      <a
        th:href="@{/login}"
        id="login"
        class="text-text-primary hover:text-text-primary/60 cursor-pointer text-xl font-normal p-2"
      >
        Login
      </a>
    </div>
  </div>
  <script th:src="@{/js/theme-toggle.js}"></script>
</nav>
